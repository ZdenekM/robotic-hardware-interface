=Řízení pohybu=

Popis řízení pohybu a zejména komunikace mezi PC a jednotlivými moduly.

==Popis komunikace mezi PC a MainMod==

PC posílá povely k jízdě přímo (požadovaná vzdálenost), nebo povel k otočení (požadovaný úhel otočení). Modul MainMod potom zajišťuje provedení těchto příkazů (kontroluje ujetou vzdálenost atd.).

TODO: doplnit popis komunikace.

==Popis komunikace mezi MainMod a moduly MotorControl==

Modul MainMod pošle příslušnému modulu MotorControl pouze požadovanou rychlost a pak sleduje ujetou vzdálenost. Pokud ujetá vzdálenost = požadovaná vzdálenost, pošle paket s nulovou požadovanou rychlostí. Pro rychlost je používána jednotka cm/s. Požadovaná rychlost je společná pro oba motory, které ovládá jeden modul MotorControl.

Paket posílaný modulem MainMod (pouze typ + datová část):

_Údaje v závorce značí počet bytů a případné znaménko (u = unsigned, s = signed). Písmeno f na konci proměnné značí přední motor (front), r naopak značí zadní motor (rear)._

||P_COMM|||rspeed||

  * P_COMM ... typ paketu příkaz (u1)
  * rspeed ... požadovaná rychlost (s2)

Na paket typu P_COMM odpoví modul MotorControl paketem P_INFO s údaji o stavu motoru. Po odeslání paketu P_INFO se vynuluje proměnná udávající ujetou vzdálenost od posledního příkazu.

||P_INFO||rspeed||aspeedf||distf||mstatef||mcurrf||mtempf||aspeedr||distr||mstatef||mcurrf||

  * P_INFO ... typ paketu informace z modulu (u1)
  * rspeed ... požadovaná rychlost (s2)
  * aspeedx ... akt. rychlost motoru (s2)
  * distx ... ujetá vzdálenost od posledního příkazu (s2)
  * mstatex ... stav motoru (u1)
  * mcurrx ... proud motorem (u1)
  * mtempx ... teplota motoru (u1)

Celkem tedy 10 bytů.